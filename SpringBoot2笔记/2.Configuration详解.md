### Configuration详解

> `User`类

```java
package com.atguigu.boot.bean;

/*
用户
* */
public class User {

    private String name;
    private Integer age;

    private  Pet pet;

    public Pet getPet() {
        return pet;
    }

    public void setPet(Pet pet) {
        this.pet = pet;
    }

    public User(){

    }
    public User(String name,Integer age){
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }

    @Override
    public String toString() {
        return "User{" +
                "name='" + name + '\'' +
                ", age=" + age +
                ", pet=" + pet +
                '}';
    }
}

```

> `Pet`类

```java
package com.atguigu.boot.bean;
/*宠物*/
public class Pet {

    private String name;

    public Pet(){

    }

    public Pet(String name) {
        this.name = name;
    }

    public String getName() {
            return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return "Pet{" +
                "name='" + name + '\'' +
                '}';
    }
}

```

>`MyConfig`类

```java
package com.atguigu.boot.config;

import com.atguigu.boot.bean.Pet;
import com.atguigu.boot.bean.User;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
/*
* 1、配置类（默认也是一个组件）里面使用@Bean标注在方法上给容器注册组件，默认也是单实例的
* 2、配置类本身也是组件
* 3、proxyBeanMethods : 代理bean的方法
*   全配置、
*   Full(proxyBeanMethods = true)
*   轻量级配置、
*   Lite(proxyBeanMethods = false)
*           组件依赖
* */
@Configuration(proxyBeanMethods = true)//告诉SpringBoot这是一个配置类 == 配置文件
public class MyConfig {
    /*
    * 外部无论对配置类中的这个组件注册方法调用多少次获取的都是之前注册容器中的单实例对象
    * */
    @Bean//给容器中添加组件。以方法名作为组件的id。返回类型就是组件类型。返回的值，就是组件在容器中的实例
    public User user01(){
        User zhangsan =  new User("zhangsan",18);
        //user组件依赖了Pet组件
        zhangsan.setPet(tomcatPet());
        return zhangsan;
    }

    @Bean("tom")//自定义一个组件名，之后就不是方法名了
    public Pet tomcatPet(){
        return new Pet("tomcat");
    }
}

```

> `MainApplication`

```java
package com.atguigu.boot;


import com.atguigu.boot.bean.Pet;
import com.atguigu.boot.bean.User;
import com.atguigu.boot.config.MyConfig;
import org.springframework.boot.SpringApplication;

import org.springframework.boot.SpringBootConfiguration;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ConfigurableApplicationContext;
import org.springframework.context.annotation.ComponentScan;


/*
 主程序类
 @SpringBootApplication：这是一个SpringBoot应用
* */
//Ctrl + F 查找文本
//@SpringBootApplication
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan("com.atguigu.boot")
class MainApplication {
    public static void main(String[] args) {
        //1、返回我们IOC容器
        ConfigurableApplicationContext run =    SpringApplication.run(MainApplication.class,args);//主类加载进来

        //2、查看容器里面的插件
        String[] names = run.getBeanDefinitionNames();
        for(String name : names){
            System.out.println(name);
        }

        //3、从容器中获取组件（默认为单实例的）
        //验证：
        Pet tom01 = run.getBean("tom",Pet.class);

        Pet tom02 = run.getBean("tom",Pet.class);

        System.out.println("组件："+(tom01 == tom02));
        //验证配置类也是一个组件

        //4、com.atguigu.boot.config.MyConfig$$EnhancerBySpringCGLIB$$8616218@3291b443
        MyConfig bean = run.getBean(MyConfig.class);
        System.out.println(bean);

        //如果@Configuration(proxyBeanMethods = true)代理对象调用方法。SpringBoot总会检查这个组件是否在容器中
        //保持组件单实例
        User user = bean.user01();
        User user1 = bean.user01();
        System.out.println(user == user1);

        User user01 = run.getBean("user01",User.class);
        Pet tom = run.getBean("tom",Pet.class);

        System.out.println("用户的宠物："+(user01.getPet() == tom));
    }
}

```

